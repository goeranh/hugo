<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Kurskompendium - introduktion till R</title>
  <meta name="description" content="Kurskompendium - introduktion till R">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Kurskompendium - introduktion till R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kurskompendium - introduktion till R" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="stada-data-tidy-data.html">
<link rel="next" href="textstrangar-strings.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.3.1/str_view.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduktion</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#basics"><i class="fa fa-check"></i><b>1.1</b> Basics</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#r-konsolen"><i class="fa fa-check"></i><b>1.2</b> R-konsolen</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#rstudio"><i class="fa fa-check"></i><b>1.3</b> RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#hjalpfunktioner"><i class="fa fa-check"></i><b>1.4</b> Hjälpfunktioner</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="utforska-data.html"><a href="utforska-data.html"><i class="fa fa-check"></i><b>2</b> Utforska data</a></li>
<li class="chapter" data-level="3" data-path="visualisering.html"><a href="visualisering.html"><i class="fa fa-check"></i><b>3</b> Visualisering</a><ul>
<li class="chapter" data-level="3.1" data-path="visualisering.html"><a href="visualisering.html#ett-forsta-diagram"><i class="fa fa-check"></i><b>3.1</b> Ett första diagram</a><ul>
<li class="chapter" data-level="3.1.1" data-path="visualisering.html"><a href="visualisering.html#ladda-data"><i class="fa fa-check"></i><b>3.1.1</b> Ladda data</a></li>
<li class="chapter" data-level="3.1.2" data-path="visualisering.html"><a href="visualisering.html#skapa-en-ggplot"><i class="fa fa-check"></i><b>3.1.2</b> Skapa en ggplot</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="visualisering.html"><a href="visualisering.html#en-grafikmall"><i class="fa fa-check"></i><b>3.2</b> En grafikmall</a></li>
<li class="chapter" data-level="3.3" data-path="visualisering.html"><a href="visualisering.html#ovningar"><i class="fa fa-check"></i><b>3.3</b> Övningar</a></li>
<li class="chapter" data-level="3.4" data-path="visualisering.html"><a href="visualisering.html#aes-funktionen-och-mappings"><i class="fa fa-check"></i><b>3.4</b> <code>aes()</code>-funktionen och mappings</a></li>
<li class="chapter" data-level="3.5" data-path="visualisering.html"><a href="visualisering.html#ovningar-1"><i class="fa fa-check"></i><b>3.5</b> Övningar</a></li>
<li class="chapter" data-level="3.6" data-path="visualisering.html"><a href="visualisering.html#vanliga-problem"><i class="fa fa-check"></i><b>3.6</b> Vanliga problem</a></li>
<li class="chapter" data-level="3.7" data-path="visualisering.html"><a href="visualisering.html#facets"><i class="fa fa-check"></i><b>3.7</b> Facets</a></li>
<li class="chapter" data-level="3.8" data-path="visualisering.html"><a href="visualisering.html#ovningar-2"><i class="fa fa-check"></i><b>3.8</b> Övningar</a></li>
<li class="chapter" data-level="3.9" data-path="visualisering.html"><a href="visualisering.html#geometriska-objekt---geoms"><i class="fa fa-check"></i><b>3.9</b> “Geometriska” objekt - geoms</a></li>
<li class="chapter" data-level="3.10" data-path="visualisering.html"><a href="visualisering.html#ovningar-3"><i class="fa fa-check"></i><b>3.10</b> Övningar</a></li>
<li class="chapter" data-level="3.11" data-path="visualisering.html"><a href="visualisering.html#statistiska-transformationer"><i class="fa fa-check"></i><b>3.11</b> Statistiska transformationer</a></li>
<li class="chapter" data-level="3.12" data-path="visualisering.html"><a href="visualisering.html#ovningar-4"><i class="fa fa-check"></i><b>3.12</b> Övningar</a></li>
<li class="chapter" data-level="3.13" data-path="visualisering.html"><a href="visualisering.html#positionering"><i class="fa fa-check"></i><b>3.13</b> Positionering</a></li>
<li class="chapter" data-level="3.14" data-path="visualisering.html"><a href="visualisering.html#ovningar-5"><i class="fa fa-check"></i><b>3.14</b> Övningar</a></li>
<li class="chapter" data-level="3.15" data-path="visualisering.html"><a href="visualisering.html#koordinatsystem"><i class="fa fa-check"></i><b>3.15</b> Koordinatsystem</a></li>
<li class="chapter" data-level="3.16" data-path="visualisering.html"><a href="visualisering.html#ovningar-6"><i class="fa fa-check"></i><b>3.16</b> Övningar</a></li>
<li class="chapter" data-level="3.17" data-path="visualisering.html"><a href="visualisering.html#the-layered-grammar-of-graphics"><i class="fa fa-check"></i><b>3.17</b> “The layered grammar of graphics”</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="workflow-basics.html"><a href="workflow-basics.html"><i class="fa fa-check"></i><b>4</b> Workflow: Basics</a><ul>
<li class="chapter" data-level="4.1" data-path="workflow-basics.html"><a href="workflow-basics.html#skriva-kod"><i class="fa fa-check"></i><b>4.1</b> Skriva kod</a></li>
<li class="chapter" data-level="4.2" data-path="workflow-basics.html"><a href="workflow-basics.html#anropa-funktioner"><i class="fa fa-check"></i><b>4.2</b> Anropa funktioner</a></li>
<li class="chapter" data-level="4.3" data-path="workflow-basics.html"><a href="workflow-basics.html#ovningar-7"><i class="fa fa-check"></i><b>4.3</b> Övningar</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="transformering-av-data.html"><a href="transformering-av-data.html"><i class="fa fa-check"></i><b>5</b> Transformering av data</a><ul>
<li class="chapter" data-level="5.1" data-path="transformering-av-data.html"><a href="transformering-av-data.html#introduktion-1"><i class="fa fa-check"></i><b>5.1</b> Introduktion</a></li>
<li class="chapter" data-level="5.2" data-path="transformering-av-data.html"><a href="transformering-av-data.html#forberedelser"><i class="fa fa-check"></i><b>5.2</b> Förberedelser</a></li>
<li class="chapter" data-level="5.3" data-path="transformering-av-data.html"><a href="transformering-av-data.html#dplyr-grunder"><i class="fa fa-check"></i><b>5.3</b> <code>dplyr</code> grunder</a><ul>
<li class="chapter" data-level="5.3.1" data-path="transformering-av-data.html"><a href="transformering-av-data.html#filtrera-raderposter-med-filter"><i class="fa fa-check"></i><b>5.3.1</b> Filtrera rader/poster med <code>filter()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="transformering-av-data.html"><a href="transformering-av-data.html#ovningar-8"><i class="fa fa-check"></i><b>5.4</b> Övningar</a></li>
<li class="chapter" data-level="5.5" data-path="transformering-av-data.html"><a href="transformering-av-data.html#arrangera-poster-med-arrange"><i class="fa fa-check"></i><b>5.5</b> Arrangera poster med <code>arrange()</code></a></li>
<li class="chapter" data-level="5.6" data-path="transformering-av-data.html"><a href="transformering-av-data.html#ovningar-9"><i class="fa fa-check"></i><b>5.6</b> Övningar</a></li>
<li class="chapter" data-level="5.7" data-path="transformering-av-data.html"><a href="transformering-av-data.html#valj-kolumner-med-select"><i class="fa fa-check"></i><b>5.7</b> Välj kolumner med <code>select()</code></a></li>
<li class="chapter" data-level="5.8" data-path="transformering-av-data.html"><a href="transformering-av-data.html#ovningar-10"><i class="fa fa-check"></i><b>5.8</b> Övningar</a></li>
<li class="chapter" data-level="5.9" data-path="transformering-av-data.html"><a href="transformering-av-data.html#lagg-till-flera-variabler-med-hjalp-av-mutate"><i class="fa fa-check"></i><b>5.9</b> Lägg till flera variabler med hjälp av <code>mutate()</code></a><ul>
<li class="chapter" data-level="5.9.1" data-path="transformering-av-data.html"><a href="transformering-av-data.html#funktioner-och-operatorer-att-anvandas-med-mutate"><i class="fa fa-check"></i><b>5.9.1</b> Funktioner och operatorer att användas med <code>mutate()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="transformering-av-data.html"><a href="transformering-av-data.html#ovningar-11"><i class="fa fa-check"></i><b>5.10</b> Övningar</a></li>
<li class="chapter" data-level="5.11" data-path="transformering-av-data.html"><a href="transformering-av-data.html#kombinera-multipla-operationer-med-the-pipe"><i class="fa fa-check"></i><b>5.11</b> Kombinera multipla operationer med the pipe</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="arbetsflode-scripts.html"><a href="arbetsflode-scripts.html"><i class="fa fa-check"></i><b>6</b> Arbetsflöde: scripts</a></li>
<li class="chapter" data-level="7" data-path="explorerande-analys-av-data.html"><a href="explorerande-analys-av-data.html"><i class="fa fa-check"></i><b>7</b> Explorerande analys av data</a></li>
<li class="chapter" data-level="8" data-path="workflow-projects.html"><a href="workflow-projects.html"><i class="fa fa-check"></i><b>8</b> Workflow: Projects</a><ul>
<li class="chapter" data-level="8.1" data-path="workflow-projects.html"><a href="workflow-projects.html#vad-ar-viktigt"><i class="fa fa-check"></i><b>8.1</b> Vad är viktigt?</a></li>
<li class="chapter" data-level="8.2" data-path="workflow-projects.html"><a href="workflow-projects.html#vart-lever-analysen-arbetsbiblioteket"><i class="fa fa-check"></i><b>8.2</b> Vart lever analysen? Arbetsbiblioteket</a></li>
<li class="chapter" data-level="8.3" data-path="workflow-projects.html"><a href="workflow-projects.html#sokvagar-och-bibliotekmappar"><i class="fa fa-check"></i><b>8.3</b> Sökvägar och bibliotek/mappar</a></li>
<li class="chapter" data-level="8.4" data-path="workflow-projects.html"><a href="workflow-projects.html#rstudio-projects-viktigt"><i class="fa fa-check"></i><b>8.4</b> RStudio projects VIKTIGT!</a></li>
<li class="chapter" data-level="8.5" data-path="workflow-projects.html"><a href="workflow-projects.html#sammanfattningsvis"><i class="fa fa-check"></i><b>8.5</b> Sammanfattningsvis</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="wrangle-att-braka-med-data.html"><a href="wrangle-att-braka-med-data.html"><i class="fa fa-check"></i><b>9</b> Wrangle - att bråka med data</a><ul>
<li class="chapter" data-level="9.1" data-path="wrangle-att-braka-med-data.html"><a href="wrangle-att-braka-med-data.html#introduktion-2"><i class="fa fa-check"></i><b>9.1</b> Introduktion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tibbles.html"><a href="tibbles.html"><i class="fa fa-check"></i><b>10</b> Tibbles</a><ul>
<li class="chapter" data-level="10.1" data-path="tibbles.html"><a href="tibbles.html#skapa-tibbles"><i class="fa fa-check"></i><b>10.1</b> Skapa tibbles</a><ul>
<li class="chapter" data-level="10.1.1" data-path="tibbles.html"><a href="tibbles.html#tibbles-vs-data-frames"><i class="fa fa-check"></i><b>10.1.1</b> Tibbles vs data frames</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tibbles.html"><a href="tibbles.html#utskrift-printing"><i class="fa fa-check"></i><b>10.2</b> Utskrift (Printing)</a></li>
<li class="chapter" data-level="10.3" data-path="tibbles.html"><a href="tibbles.html#urval"><i class="fa fa-check"></i><b>10.3</b> Urval</a></li>
<li class="chapter" data-level="10.4" data-path="tibbles.html"><a href="tibbles.html#anvanda-aldre-kod"><i class="fa fa-check"></i><b>10.4</b> Använda äldre kod</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="importera-data.html"><a href="importera-data.html"><i class="fa fa-check"></i><b>11</b> Importera data</a><ul>
<li class="chapter" data-level="11.1" data-path="importera-data.html"><a href="importera-data.html#jamforelse-med-base-r"><i class="fa fa-check"></i><b>11.1</b> Jämförelse med base R</a></li>
<li class="chapter" data-level="11.2" data-path="importera-data.html"><a href="importera-data.html#ovningar-12"><i class="fa fa-check"></i><b>11.2</b> Övningar</a></li>
<li class="chapter" data-level="11.3" data-path="importera-data.html"><a href="importera-data.html#omvandla-vektorer"><i class="fa fa-check"></i><b>11.3</b> Omvandla vektorer</a><ul>
<li class="chapter" data-level="11.3.1" data-path="importera-data.html"><a href="importera-data.html#numeriska-variabler"><i class="fa fa-check"></i><b>11.3.1</b> Numeriska variabler</a></li>
<li class="chapter" data-level="11.3.2" data-path="importera-data.html"><a href="importera-data.html#textstrangar"><i class="fa fa-check"></i><b>11.3.2</b> Textsträngar</a></li>
<li class="chapter" data-level="11.3.3" data-path="importera-data.html"><a href="importera-data.html#kategoriska-data"><i class="fa fa-check"></i><b>11.3.3</b> Kategoriska data</a></li>
<li class="chapter" data-level="11.3.4" data-path="importera-data.html"><a href="importera-data.html#datum-och-tid"><i class="fa fa-check"></i><b>11.3.4</b> Datum och tid</a></li>
<li class="chapter" data-level="11.3.5" data-path="importera-data.html"><a href="importera-data.html#ovningar-13"><i class="fa fa-check"></i><b>11.3.5</b> Övningar</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="importera-data.html"><a href="importera-data.html#hur-readr-plockar-isar-parse-en-fil"><i class="fa fa-check"></i><b>11.4</b> Hur <code>readr</code> “plockar isär” (parse) en fil</a></li>
<li class="chapter" data-level="11.5" data-path="importera-data.html"><a href="importera-data.html#problem"><i class="fa fa-check"></i><b>11.5</b> Problem</a></li>
<li class="chapter" data-level="11.6" data-path="importera-data.html"><a href="importera-data.html#skriva-till-en-fil"><i class="fa fa-check"></i><b>11.6</b> Skriva till en fil</a></li>
<li class="chapter" data-level="11.7" data-path="importera-data.html"><a href="importera-data.html#andra-datatyper"><i class="fa fa-check"></i><b>11.7</b> Andra datatyper</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html"><i class="fa fa-check"></i><b>12</b> Städa data (tidy data)</a><ul>
<li class="chapter" data-level="12.1" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html#introduktion-3"><i class="fa fa-check"></i><b>12.1</b> Introduktion</a></li>
<li class="chapter" data-level="12.2" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html#spreading-and-gathering"><i class="fa fa-check"></i><b>12.2</b> Spreading and gathering</a><ul>
<li class="chapter" data-level="12.2.1" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html#gathering"><i class="fa fa-check"></i><b>12.2.1</b> Gathering</a></li>
<li class="chapter" data-level="12.2.2" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html#spreading"><i class="fa fa-check"></i><b>12.2.2</b> Spreading</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html#ovningar-14"><i class="fa fa-check"></i><b>12.3</b> Övningar</a></li>
<li class="chapter" data-level="12.4" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html#separera-och-forena"><i class="fa fa-check"></i><b>12.4</b> Separera och förena</a><ul>
<li class="chapter" data-level="12.4.1" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html#separate"><i class="fa fa-check"></i><b>12.4.1</b> Separate</a></li>
<li class="chapter" data-level="12.4.2" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html#unite"><i class="fa fa-check"></i><b>12.4.2</b> Unite</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html#ovningar-15"><i class="fa fa-check"></i><b>12.5</b> Övningar</a></li>
<li class="chapter" data-level="12.6" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html#missing-values"><i class="fa fa-check"></i><b>12.6</b> Missing values</a></li>
<li class="chapter" data-level="12.7" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html#ovningar-16"><i class="fa fa-check"></i><b>12.7</b> Övningar</a></li>
<li class="chapter" data-level="12.8" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html#en-case-study"><i class="fa fa-check"></i><b>12.8</b> En case study</a></li>
<li class="chapter" data-level="12.9" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html#ovningar-17"><i class="fa fa-check"></i><b>12.9</b> Övningar</a></li>
<li class="chapter" data-level="12.10" data-path="stada-data-tidy-data.html"><a href="stada-data-tidy-data.html#non-tidy-data"><i class="fa fa-check"></i><b>12.10</b> Non-tidy data</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="relationer-mellan-datamangder.html"><a href="relationer-mellan-datamangder.html"><i class="fa fa-check"></i><b>13</b> Relationer mellan datamängder</a><ul>
<li class="chapter" data-level="13.1" data-path="relationer-mellan-datamangder.html"><a href="relationer-mellan-datamangder.html#introduktion-4"><i class="fa fa-check"></i><b>13.1</b> Introduktion</a></li>
<li class="chapter" data-level="13.2" data-path="relationer-mellan-datamangder.html"><a href="relationer-mellan-datamangder.html#nycflights13"><i class="fa fa-check"></i><b>13.2</b> <code>nycflights13</code></a></li>
<li class="chapter" data-level="13.3" data-path="relationer-mellan-datamangder.html"><a href="relationer-mellan-datamangder.html#keys"><i class="fa fa-check"></i><b>13.3</b> Keys</a></li>
<li class="chapter" data-level="13.4" data-path="relationer-mellan-datamangder.html"><a href="relationer-mellan-datamangder.html#mutating-joins"><i class="fa fa-check"></i><b>13.4</b> <em>Mutating joins</em></a><ul>
<li class="chapter" data-level="13.4.1" data-path="relationer-mellan-datamangder.html"><a href="relationer-mellan-datamangder.html#att-forsta-joins"><i class="fa fa-check"></i><b>13.4.1</b> Att förstå <em>joins</em></a></li>
<li class="chapter" data-level="13.4.2" data-path="relationer-mellan-datamangder.html"><a href="relationer-mellan-datamangder.html#inner-join"><i class="fa fa-check"></i><b>13.4.2</b> Inner join</a></li>
<li class="chapter" data-level="13.4.3" data-path="relationer-mellan-datamangder.html"><a href="relationer-mellan-datamangder.html#outer-joins"><i class="fa fa-check"></i><b>13.4.3</b> Outer joins</a></li>
<li class="chapter" data-level="13.4.4" data-path="relationer-mellan-datamangder.html"><a href="relationer-mellan-datamangder.html#duplicate-keys"><i class="fa fa-check"></i><b>13.4.4</b> Duplicate keys</a></li>
<li class="chapter" data-level="13.4.5" data-path="relationer-mellan-datamangder.html"><a href="relationer-mellan-datamangder.html#definiera-nyckel-kolumner-key-columns"><i class="fa fa-check"></i><b>13.4.5</b> Definiera nyckel-kolumner (<em>key columns</em>)</a></li>
<li class="chapter" data-level="13.4.6" data-path="relationer-mellan-datamangder.html"><a href="relationer-mellan-datamangder.html#ovningar-18"><i class="fa fa-check"></i><b>13.4.6</b> Övningar</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="relationer-mellan-datamangder.html"><a href="relationer-mellan-datamangder.html#filtering-joins"><i class="fa fa-check"></i><b>13.5</b> <em>Filtering joins</em></a></li>
<li class="chapter" data-level="13.6" data-path="relationer-mellan-datamangder.html"><a href="relationer-mellan-datamangder.html#problem-med-joins"><i class="fa fa-check"></i><b>13.6</b> Problem med <em>joins</em></a></li>
<li class="chapter" data-level="13.7" data-path="relationer-mellan-datamangder.html"><a href="relationer-mellan-datamangder.html#set-operations"><i class="fa fa-check"></i><b>13.7</b> Set operations</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html"><i class="fa fa-check"></i><b>14</b> Textsträngar (strings)</a><ul>
<li class="chapter" data-level="14.1" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#introduktion-5"><i class="fa fa-check"></i><b>14.1</b> Introduktion</a></li>
<li class="chapter" data-level="14.2" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#basics-1"><i class="fa fa-check"></i><b>14.2</b> Basics</a><ul>
<li class="chapter" data-level="14.2.1" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#stringr-funktioner"><i class="fa fa-check"></i><b>14.2.1</b> <code>stringr</code>-funktioner</a></li>
<li class="chapter" data-level="14.2.2" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#kombinera-strangar"><i class="fa fa-check"></i><b>14.2.2</b> Kombinera strängar</a></li>
<li class="chapter" data-level="14.2.3" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#extrahera-delar-av-textstrangar-subsetting"><i class="fa fa-check"></i><b>14.2.3</b> Extrahera delar av textsträngar (subsetting)</a></li>
<li class="chapter" data-level="14.2.4" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#ovningar-19"><i class="fa fa-check"></i><b>14.2.4</b> Övningar</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#matcha-textmonster-med-hjalp-av-regular-expressions"><i class="fa fa-check"></i><b>14.3</b> Matcha textmönster med hjälp av <em>regular expressions</em></a><ul>
<li class="chapter" data-level="14.3.1" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#basic-matches"><i class="fa fa-check"></i><b>14.3.1</b> Basic matches</a></li>
<li class="chapter" data-level="14.3.2" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#ankare-anchors"><i class="fa fa-check"></i><b>14.3.2</b> Ankare (Anchors)</a></li>
<li class="chapter" data-level="14.3.3" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#tecken-klasser"><i class="fa fa-check"></i><b>14.3.3</b> Tecken-klasser</a></li>
<li class="chapter" data-level="14.3.4" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#repeterande-tecken"><i class="fa fa-check"></i><b>14.3.4</b> Repeterande tecken</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#verktyg"><i class="fa fa-check"></i><b>14.4</b> Verktyg</a><ul>
<li class="chapter" data-level="14.4.1" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#upptack-matchningar"><i class="fa fa-check"></i><b>14.4.1</b> Upptäck matchningar</a></li>
<li class="chapter" data-level="14.4.2" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#ovningar-22"><i class="fa fa-check"></i><b>14.4.2</b> Övningar</a></li>
<li class="chapter" data-level="14.4.3" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#extrahera-matchningar"><i class="fa fa-check"></i><b>14.4.3</b> Extrahera matchningar</a></li>
<li class="chapter" data-level="14.4.4" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#gruppereade-matchningar"><i class="fa fa-check"></i><b>14.4.4</b> Gruppereade matchningar</a></li>
<li class="chapter" data-level="14.4.5" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#ersatt-matchningar"><i class="fa fa-check"></i><b>14.4.5</b> Ersätt matchningar</a></li>
<li class="chapter" data-level="14.4.6" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#dela-upp-textstrangar"><i class="fa fa-check"></i><b>14.4.6</b> Dela upp textsträngar</a></li>
<li class="chapter" data-level="14.4.7" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#hitta-matchningar"><i class="fa fa-check"></i><b>14.4.7</b> Hitta matchningar</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#andra-typer-av-monster"><i class="fa fa-check"></i><b>14.5</b> Andra typer av mönster</a></li>
<li class="chapter" data-level="14.6" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#andra-typer-av-regexps"><i class="fa fa-check"></i><b>14.6</b> Andra typer av regexps</a></li>
<li class="chapter" data-level="14.7" data-path="textstrangar-strings.html"><a href="textstrangar-strings.html#stringi"><i class="fa fa-check"></i><b>14.7</b> stringi</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="kategoriska-variabler-factors.html"><a href="kategoriska-variabler-factors.html"><i class="fa fa-check"></i><b>15</b> Kategoriska variabler (Factors)</a><ul>
<li class="chapter" data-level="15.1" data-path="kategoriska-variabler-factors.html"><a href="kategoriska-variabler-factors.html#introduktion-6"><i class="fa fa-check"></i><b>15.1</b> Introduktion</a></li>
<li class="chapter" data-level="15.2" data-path="kategoriska-variabler-factors.html"><a href="kategoriska-variabler-factors.html#skapa-factors"><i class="fa fa-check"></i><b>15.2</b> Skapa factors</a></li>
<li class="chapter" data-level="15.3" data-path="kategoriska-variabler-factors.html"><a href="kategoriska-variabler-factors.html#general-social-survey"><i class="fa fa-check"></i><b>15.3</b> General Social Survey</a></li>
<li class="chapter" data-level="15.4" data-path="kategoriska-variabler-factors.html"><a href="kategoriska-variabler-factors.html#modifiera-ordningen-av-factors"><i class="fa fa-check"></i><b>15.4</b> Modifiera ordningen av factors</a></li>
<li class="chapter" data-level="15.5" data-path="kategoriska-variabler-factors.html"><a href="kategoriska-variabler-factors.html#modifiera-factor-levels"><i class="fa fa-check"></i><b>15.5</b> Modifiera factor levels</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html"><i class="fa fa-check"></i><b>16</b> Datum och tidsformat</a><ul>
<li class="chapter" data-level="16.1" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#introduktion-7"><i class="fa fa-check"></i><b>16.1</b> Introduktion</a></li>
<li class="chapter" data-level="16.2" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#skapa-datum-och-tid"><i class="fa fa-check"></i><b>16.2</b> Skapa datum och tid</a><ul>
<li class="chapter" data-level="16.2.1" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#fran-textstrangar"><i class="fa fa-check"></i><b>16.2.1</b> Från textsträngar</a></li>
<li class="chapter" data-level="16.2.2" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#fran-enskilda-kompnenter"><i class="fa fa-check"></i><b>16.2.2</b> Från enskilda kompnenter</a></li>
<li class="chapter" data-level="16.2.3" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#fran-andra-datumtid-format"><i class="fa fa-check"></i><b>16.2.3</b> Från andra datum/tid-format</a></li>
<li class="chapter" data-level="16.2.4" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#ovningar-23"><i class="fa fa-check"></i><b>16.2.4</b> Övningar</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#datumtid-komponenter"><i class="fa fa-check"></i><b>16.3</b> Datum/tid-komponenter</a><ul>
<li class="chapter" data-level="16.3.1" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#extrahera-komponenter"><i class="fa fa-check"></i><b>16.3.1</b> Extrahera komponenter</a></li>
<li class="chapter" data-level="16.3.2" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#avrundning"><i class="fa fa-check"></i><b>16.3.2</b> Avrundning</a></li>
<li class="chapter" data-level="16.3.3" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#ange-komponenter"><i class="fa fa-check"></i><b>16.3.3</b> Ange komponenter</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#tidsintervall"><i class="fa fa-check"></i><b>16.4</b> Tidsintervall</a><ul>
<li class="chapter" data-level="16.4.1" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#varaktighet"><i class="fa fa-check"></i><b>16.4.1</b> Varaktighet</a></li>
<li class="chapter" data-level="16.4.2" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#perioder"><i class="fa fa-check"></i><b>16.4.2</b> Perioder</a></li>
<li class="chapter" data-level="16.4.3" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#intervall"><i class="fa fa-check"></i><b>16.4.3</b> Intervall</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="datum-och-tidsformat.html"><a href="datum-och-tidsformat.html#summering"><i class="fa fa-check"></i><b>16.5</b> Summering</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="programmering-i-r.html"><a href="programmering-i-r.html"><i class="fa fa-check"></i><b>17</b> Programmering i R</a><ul>
<li class="chapter" data-level="17.1" data-path="programmering-i-r.html"><a href="programmering-i-r.html#introduktion-8"><i class="fa fa-check"></i><b>17.1</b> Introduktion</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="pipes.html"><a href="pipes.html"><i class="fa fa-check"></i><b>18</b> Pipes</a></li>
<li class="chapter" data-level="19" data-path="funktioner.html"><a href="funktioner.html"><i class="fa fa-check"></i><b>19</b> Funktioner</a><ul>
<li class="chapter" data-level="19.1" data-path="funktioner.html"><a href="funktioner.html#nar-bor-du-skapa-en-funktion"><i class="fa fa-check"></i><b>19.1</b> När bör du skapa en funktion?</a></li>
<li class="chapter" data-level="19.2" data-path="funktioner.html"><a href="funktioner.html#funktioner-ar-till-for-manniskor-och-datorer"><i class="fa fa-check"></i><b>19.2</b> Funktioner är till för människor och datorer</a></li>
<li class="chapter" data-level="19.3" data-path="funktioner.html"><a href="funktioner.html#villkorlig-exekvering"><i class="fa fa-check"></i><b>19.3</b> Villkorlig exekvering</a><ul>
<li class="chapter" data-level="19.3.1" data-path="funktioner.html"><a href="funktioner.html#villkor"><i class="fa fa-check"></i><b>19.3.1</b> Villkor</a></li>
<li class="chapter" data-level="19.3.2" data-path="funktioner.html"><a href="funktioner.html#multipla-villkor"><i class="fa fa-check"></i><b>19.3.2</b> Multipla villkor</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="funktioner.html"><a href="funktioner.html#funktionsargument"><i class="fa fa-check"></i><b>19.4</b> Funktionsargument</a></li>
<li class="chapter" data-level="19.5" data-path="funktioner.html"><a href="funktioner.html#kolla-varden"><i class="fa fa-check"></i><b>19.5</b> Kolla värden</a></li>
<li class="chapter" data-level="19.6" data-path="funktioner.html"><a href="funktioner.html#punkt-punkt-punkt"><i class="fa fa-check"></i><b>19.6</b> punkt-punkt-punkt</a></li>
<li class="chapter" data-level="19.7" data-path="funktioner.html"><a href="funktioner.html#returnera-varden"><i class="fa fa-check"></i><b>19.7</b> Returnera värden</a><ul>
<li class="chapter" data-level="19.7.1" data-path="funktioner.html"><a href="funktioner.html#explicita-return-uttryck"><i class="fa fa-check"></i><b>19.7.1</b> Explicita <code>return</code>-uttryck</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="funktioner.html"><a href="funktioner.html#skriva-funktioner-med-hjalp-av-pipes"><i class="fa fa-check"></i><b>19.8</b> Skriva funktioner med hjälp av pipes</a></li>
<li class="chapter" data-level="19.9" data-path="funktioner.html"><a href="funktioner.html#environment-svart-hitta-ett-svenskt-uttryck"><i class="fa fa-check"></i><b>19.9</b> Environment (svårt hitta ett svenskt uttryck)</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="vektorer.html"><a href="vektorer.html"><i class="fa fa-check"></i><b>20</b> Vektorer</a><ul>
<li class="chapter" data-level="20.1" data-path="vektorer.html"><a href="vektorer.html#introduktion-9"><i class="fa fa-check"></i><b>20.1</b> Introduktion</a></li>
<li class="chapter" data-level="20.2" data-path="vektorer.html"><a href="vektorer.html#atomic-vectors"><i class="fa fa-check"></i><b>20.2</b> Atomic vectors</a><ul>
<li class="chapter" data-level="20.2.1" data-path="vektorer.html"><a href="vektorer.html#logical-vectors"><i class="fa fa-check"></i><b>20.2.1</b> Logical vectors</a></li>
<li class="chapter" data-level="20.2.2" data-path="vektorer.html"><a href="vektorer.html#numeriska-vektorer"><i class="fa fa-check"></i><b>20.2.2</b> Numeriska vektorer</a></li>
<li class="chapter" data-level="20.2.3" data-path="vektorer.html"><a href="vektorer.html#character"><i class="fa fa-check"></i><b>20.2.3</b> Character</a></li>
<li class="chapter" data-level="20.2.4" data-path="vektorer.html"><a href="vektorer.html#anvanda-atomic-vectors"><i class="fa fa-check"></i><b>20.2.4</b> Använda atomic vectors</a></li>
<li class="chapter" data-level="20.2.5" data-path="vektorer.html"><a href="vektorer.html#scalars-och-recycling"><i class="fa fa-check"></i><b>20.2.5</b> Scalars och recycling</a></li>
<li class="chapter" data-level="20.2.6" data-path="vektorer.html"><a href="vektorer.html#rekursiva-vektorer-lists"><i class="fa fa-check"></i><b>20.2.6</b> Rekursiva vektorer (lists)</a></li>
<li class="chapter" data-level="20.2.7" data-path="vektorer.html"><a href="vektorer.html#attribut"><i class="fa fa-check"></i><b>20.2.7</b> Attribut</a></li>
<li class="chapter" data-level="20.2.8" data-path="vektorer.html"><a href="vektorer.html#forstarkta-vektorer-augmented-vectors"><i class="fa fa-check"></i><b>20.2.8</b> Förstärkta vektorer (Augmented vectors)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="itereringar.html"><a href="itereringar.html"><i class="fa fa-check"></i><b>21</b> Itereringar</a><ul>
<li class="chapter" data-level="21.1" data-path="itereringar.html"><a href="itereringar.html#for-loops"><i class="fa fa-check"></i><b>21.1</b> For-loops</a></li>
<li class="chapter" data-level="21.2" data-path="itereringar.html"><a href="itereringar.html#variationer-av-for-loopar"><i class="fa fa-check"></i><b>21.2</b> Variationer av for-loopar</a><ul>
<li class="chapter" data-level="21.2.1" data-path="itereringar.html"><a href="itereringar.html#modifiera-ett-existerande-obkjekt"><i class="fa fa-check"></i><b>21.2.1</b> Modifiera ett existerande obkjekt</a></li>
<li class="chapter" data-level="21.2.2" data-path="itereringar.html"><a href="itereringar.html#nar-langden-pa-output-inte-ar-kand"><i class="fa fa-check"></i><b>21.2.2</b> När längden på output inte är känd</a></li>
<li class="chapter" data-level="21.2.3" data-path="itereringar.html"><a href="itereringar.html#nar-sekvensens-langd-ar-okand"><i class="fa fa-check"></i><b>21.2.3</b> När sekvensens längd är okänd</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="itereringar.html"><a href="itereringar.html#for-loops-vs.funktioner"><i class="fa fa-check"></i><b>21.3</b> for-loops vs. Funktioner</a></li>
<li class="chapter" data-level="21.4" data-path="itereringar.html"><a href="itereringar.html#mappningsfunktioner"><i class="fa fa-check"></i><b>21.4</b> Mappningsfunktioner</a><ul>
<li class="chapter" data-level="21.4.1" data-path="itereringar.html"><a href="itereringar.html#genvagar"><i class="fa fa-check"></i><b>21.4.1</b> Genvägar</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="itereringar.html"><a href="itereringar.html#hantera-errors"><i class="fa fa-check"></i><b>21.5</b> Hantera errors</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>22</b> Introduction</a></li>
<li class="chapter" data-level="23" data-path="modellering-basics.html"><a href="modellering-basics.html"><i class="fa fa-check"></i><b>23</b> Modellering: basics</a><ul>
<li class="chapter" data-level="23.1" data-path="modellering-basics.html"><a href="modellering-basics.html#en-enkel-modell"><i class="fa fa-check"></i><b>23.1</b> En enkel modell</a></li>
<li class="chapter" data-level="23.2" data-path="modellering-basics.html"><a href="modellering-basics.html#visualisera-modeller"><i class="fa fa-check"></i><b>23.2</b> Visualisera modeller</a><ul>
<li class="chapter" data-level="23.2.1" data-path="modellering-basics.html"><a href="modellering-basics.html#prediktioner"><i class="fa fa-check"></i><b>23.2.1</b> Prediktioner</a></li>
<li class="chapter" data-level="23.2.2" data-path="modellering-basics.html"><a href="modellering-basics.html#residualer"><i class="fa fa-check"></i><b>23.2.2</b> Residualer</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="modellering-basics.html"><a href="modellering-basics.html#formler-och-modell-familjer"><i class="fa fa-check"></i><b>23.3</b> Formler och modell-familjer</a><ul>
<li class="chapter" data-level="23.3.1" data-path="modellering-basics.html"><a href="modellering-basics.html#kategoriska-variabler"><i class="fa fa-check"></i><b>23.3.1</b> Kategoriska variabler</a></li>
<li class="chapter" data-level="23.3.2" data-path="modellering-basics.html"><a href="modellering-basics.html#interaktioner"><i class="fa fa-check"></i><b>23.3.2</b> Interaktioner</a></li>
<li class="chapter" data-level="23.3.3" data-path="modellering-basics.html"><a href="modellering-basics.html#interaktioner-tva-kontinuerliga-variabler"><i class="fa fa-check"></i><b>23.3.3</b> Interaktioner (två kontinuerliga variabler)</a></li>
<li class="chapter" data-level="23.3.4" data-path="modellering-basics.html"><a href="modellering-basics.html#transformationer"><i class="fa fa-check"></i><b>23.3.4</b> Transformationer</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="modellering-basics.html"><a href="modellering-basics.html#missing-values-1"><i class="fa fa-check"></i><b>23.4</b> Missing values</a><ul>
<li class="chapter" data-level="23.4.1" data-path="modellering-basics.html"><a href="modellering-basics.html#andra-modell-familjer"><i class="fa fa-check"></i><b>23.4.1</b> Andra modell-familjer</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="bygga-modeller-i-r.html"><a href="bygga-modeller-i-r.html"><i class="fa fa-check"></i><b>24</b> Bygga modeller i R</a><ul>
<li class="chapter" data-level="24.1" data-path="bygga-modeller-i-r.html"><a href="bygga-modeller-i-r.html#varfor-ar-diamanter-av-lag-kvalitet-dyrare"><i class="fa fa-check"></i><b>24.1</b> Varför är diamanter av låg kvalitet dyrare?</a><ul>
<li class="chapter" data-level="24.1.1" data-path="bygga-modeller-i-r.html"><a href="bygga-modeller-i-r.html#sambandet-pris-och-karat"><i class="fa fa-check"></i><b>24.1.1</b> Sambandet pris och karat</a></li>
<li class="chapter" data-level="24.1.2" data-path="bygga-modeller-i-r.html"><a href="bygga-modeller-i-r.html#en-mer-komplicerad-modell"><i class="fa fa-check"></i><b>24.1.2</b> En mer komplicerad modell</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="bygga-modeller-i-r.html"><a href="bygga-modeller-i-r.html#vad-ar-det-som-paverkar-antalet-dagliga-flighter"><i class="fa fa-check"></i><b>24.2</b> Vad är det som påverkar antalet dagliga flighter?</a><ul>
<li class="chapter" data-level="24.2.1" data-path="bygga-modeller-i-r.html"><a href="bygga-modeller-i-r.html#veckodag"><i class="fa fa-check"></i><b>24.2.1</b> Veckodag</a></li>
<li class="chapter" data-level="24.2.2" data-path="bygga-modeller-i-r.html"><a href="bygga-modeller-i-r.html#lordags-effekten"><i class="fa fa-check"></i><b>24.2.2</b> Lördags-effekten</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="bygga-modeller-i-r.html"><a href="bygga-modeller-i-r.html#lara-mer-om-modellering"><i class="fa fa-check"></i><b>24.3</b> Lära mer om modellering</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="grafik-for-att-kommunicera.html"><a href="grafik-for-att-kommunicera.html"><i class="fa fa-check"></i><b>25</b> Grafik för att kommunicera</a><ul>
<li class="chapter" data-level="25.1" data-path="grafik-for-att-kommunicera.html"><a href="grafik-for-att-kommunicera.html#etiketter-labels"><i class="fa fa-check"></i><b>25.1</b> Etiketter (labels)</a></li>
<li class="chapter" data-level="25.2" data-path="grafik-for-att-kommunicera.html"><a href="grafik-for-att-kommunicera.html#annoteringar"><i class="fa fa-check"></i><b>25.2</b> Annoteringar</a></li>
<li class="chapter" data-level="25.3" data-path="grafik-for-att-kommunicera.html"><a href="grafik-for-att-kommunicera.html#scales"><i class="fa fa-check"></i><b>25.3</b> Scales</a><ul>
<li class="chapter" data-level="25.3.1" data-path="grafik-for-att-kommunicera.html"><a href="grafik-for-att-kommunicera.html#axis-ticks-och-teckenforklaringar"><i class="fa fa-check"></i><b>25.3.1</b> Axis ticks och teckenförklaringar</a></li>
<li class="chapter" data-level="25.3.2" data-path="grafik-for-att-kommunicera.html"><a href="grafik-for-att-kommunicera.html#teckenforklaringens-legend-layout"><i class="fa fa-check"></i><b>25.3.2</b> Teckenförklaringens (legend) layout</a></li>
<li class="chapter" data-level="25.3.3" data-path="grafik-for-att-kommunicera.html"><a href="grafik-for-att-kommunicera.html#byta-ut-en-scale"><i class="fa fa-check"></i><b>25.3.3</b> Byta ut en scale</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="grafik-for-att-kommunicera.html"><a href="grafik-for-att-kommunicera.html#zooming"><i class="fa fa-check"></i><b>25.4</b> Zooming</a><ul>
<li class="chapter" data-level="25.4.1" data-path="grafik-for-att-kommunicera.html"><a href="grafik-for-att-kommunicera.html#teman-themes"><i class="fa fa-check"></i><b>25.4.1</b> Teman (themes)</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="grafik-for-att-kommunicera.html"><a href="grafik-for-att-kommunicera.html#spara-graferna"><i class="fa fa-check"></i><b>25.5</b> Spara graferna</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Kurskompendium - introduktion till R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="relationer-mellan-datamangder" class="section level1">
<h1><span class="header-section-number">13</span> Relationer mellan datamängder</h1>
<div id="introduktion-4" class="section level2">
<h2><span class="header-section-number">13.1</span> Introduktion</h2>
<p>Oftast omfattar en analys av data att kombinera flera tabeller, att relatera dem till varandra.
Relationer definieras alltid mellan två tabeller - relationerna mellan tre eller flera tabeller bygger alltid på att det finns en relation mellan ett par tabeller.
För att arbeta med relationer behövs alltså <em>ett antal verb</em> för att arbeta med tabell-par. Det finns tre typer av sådana verb:</p>
<ol style="list-style-type: decimal">
<li><em>Mutating joins</em> - lägger till nya variabler till en tabell från matchande observationer i en annan tabell.</li>
<li><em>Filtering joins</em> - filtrerar observationer från en tabell baserat på om de matchar observationer i en annan tabell eller inte.</li>
<li><em>Set operations</em> - behandlar observationer som om de vore en uppsättning element.</li>
</ol>
<p>Vi ska använda data från modulen <code>nycflights13</code>:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb313-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb313-2" data-line-number="2"><span class="kw">library</span>(nycflights13)</a></code></pre></div>
</div>
<div id="nycflights13" class="section level2">
<h2><span class="header-section-number">13.2</span> <code>nycflights13</code></h2>
<p><code>nycflights13</code> innehåller fyra tibbles relaterade till tabellen <code>flights</code> som vi använde i data transformation:</p>
<ol style="list-style-type: decimal">
<li><code>airlines</code> innehåller det fullständiga namnet på fraktlinjebolaget och deras förkortningar:</li>
</ol>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb314-1" data-line-number="1">airlines</a></code></pre></div>
<pre><code>## # A tibble: 16 x 2
##    carrier name                       
##    &lt;chr&gt;   &lt;chr&gt;                      
##  1 9E      Endeavor Air Inc.          
##  2 AA      American Airlines Inc.     
##  3 AS      Alaska Airlines Inc.       
##  4 B6      JetBlue Airways            
##  5 DL      Delta Air Lines Inc.       
##  6 EV      ExpressJet Airlines Inc.   
##  7 F9      Frontier Airlines Inc.     
##  8 FL      AirTran Airways Corporation
##  9 HA      Hawaiian Airlines Inc.     
## 10 MQ      Envoy Air                  
## 11 OO      SkyWest Airlines Inc.      
## 12 UA      United Air Lines Inc.      
## 13 US      US Airways Inc.            
## 14 VX      Virgin America             
## 15 WN      Southwest Airlines Co.     
## 16 YV      Mesa Airlines Inc.</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><code>airports</code> innehåller information om varje flygplats, identifierad via dess flygplatskod:</li>
</ol>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" data-line-number="1">airports</a></code></pre></div>
<pre><code>## # A tibble: 1,458 x 8
##    faa   name                   lat    lon   alt    tz dst   tzone        
##    &lt;chr&gt; &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        
##  1 04G   Lansdowne Airport     41.1  -80.6  1044    -5 A     America/New_~
##  2 06A   Moton Field Municip~  32.5  -85.7   264    -6 A     America/Chic~
##  3 06C   Schaumburg Regional   42.0  -88.1   801    -6 A     America/Chic~
##  4 06N   Randall Airport       41.4  -74.4   523    -5 A     America/New_~
##  5 09J   Jekyll Island Airpo~  31.1  -81.4    11    -5 A     America/New_~
##  6 0A9   Elizabethton Munici~  36.4  -82.2  1593    -5 A     America/New_~
##  7 0G6   Williams County Air~  41.5  -84.5   730    -5 A     America/New_~
##  8 0G7   Finger Lakes Region~  42.9  -76.8   492    -5 A     America/New_~
##  9 0P2   Shoestring Aviation~  39.8  -76.6  1000    -5 U     America/New_~
## 10 0S9   Jefferson County In~  48.1 -123.    108    -8 A     America/Los_~
## # ... with 1,448 more rows</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><code>planes</code> innehåller information om varje plan identifierad via dess tailnum:</li>
</ol>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" data-line-number="1">planes</a></code></pre></div>
<pre><code>## # A tibble: 3,322 x 9
##    tailnum  year type      manufacturer  model  engines seats speed engine
##    &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;         &lt;chr&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
##  1 N10156   2004 Fixed wi~ EMBRAER       EMB-1~       2    55    NA Turbo~
##  2 N102UW   1998 Fixed wi~ AIRBUS INDUS~ A320-~       2   182    NA Turbo~
##  3 N103US   1999 Fixed wi~ AIRBUS INDUS~ A320-~       2   182    NA Turbo~
##  4 N104UW   1999 Fixed wi~ AIRBUS INDUS~ A320-~       2   182    NA Turbo~
##  5 N10575   2002 Fixed wi~ EMBRAER       EMB-1~       2    55    NA Turbo~
##  6 N105UW   1999 Fixed wi~ AIRBUS INDUS~ A320-~       2   182    NA Turbo~
##  7 N107US   1999 Fixed wi~ AIRBUS INDUS~ A320-~       2   182    NA Turbo~
##  8 N108UW   1999 Fixed wi~ AIRBUS INDUS~ A320-~       2   182    NA Turbo~
##  9 N109UW   1999 Fixed wi~ AIRBUS INDUS~ A320-~       2   182    NA Turbo~
## 10 N110UW   1999 Fixed wi~ AIRBUS INDUS~ A320-~       2   182    NA Turbo~
## # ... with 3,312 more rows</code></pre>
<ol start="4" style="list-style-type: decimal">
<li><code>weather</code> innehåller information om vädret vid varje NYC airport per timma:</li>
</ol>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb320-1" data-line-number="1">weather</a></code></pre></div>
<pre><code>## # A tibble: 26,115 x 15
##    origin  year month   day  hour  temp  dewp humid wind_dir wind_speed
##    &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
##  1 EWR     2013     1     1     1  39.0  26.1  59.4      270      10.4 
##  2 EWR     2013     1     1     2  39.0  27.0  61.6      250       8.06
##  3 EWR     2013     1     1     3  39.0  28.0  64.4      240      11.5 
##  4 EWR     2013     1     1     4  39.9  28.0  62.2      250      12.7 
##  5 EWR     2013     1     1     5  39.0  28.0  64.4      260      12.7 
##  6 EWR     2013     1     1     6  37.9  28.0  67.2      240      11.5 
##  7 EWR     2013     1     1     7  39.0  28.0  64.4      240      15.0 
##  8 EWR     2013     1     1     8  39.9  28.0  62.2      250      10.4 
##  9 EWR     2013     1     1     9  39.9  28.0  62.2      260      15.0 
## 10 EWR     2013     1     1    10  41    28.0  59.6      260      13.8 
## # ... with 26,105 more rows, and 5 more variables: wind_gust &lt;dbl&gt;,
## #   precip &lt;dbl&gt;, pressure &lt;dbl&gt;, visib &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Ett sätt att visa relationerna mellan dessa tabeller är med ett diagram:</p>
<p><img src="relational-nycflights.png" /></p>
<p>Notera att relationerna alltid bygger på relationer mellan två tabeller:</p>
<ul>
<li><code>flights</code> relaterar till <code>planes</code> via tailnum.</li>
<li><code>flights</code> relaterar till <code>airlines</code> via <code>carrier</code> .</li>
<li><code>flights</code> relaterar till <code>airports</code> via <code>origin</code> och <code>dest</code>.</li>
<li><code>flights</code> relaterar till <code>weather</code> via <code>origin</code> (geografi), och <code>year</code>, <code>month</code>, <code>day</code> och <code>hour</code> (tidpunkt).</li>
</ul>
</div>
<div id="keys" class="section level2">
<h2><span class="header-section-number">13.3</span> Keys</h2>
<p>Variablerna som används för att koppla ihop tabeller kallas <em>keys.</em> En key är en variabel (eller variabler) som <strong>entydigt</strong> identifierar en observation. Det finns två typer av <em>keys</em>:</p>
<ol style="list-style-type: decimal">
<li>En <em>primary key</em> identifierar entydigt en observation i samma tabell. T.ex. <code>planes$tailnum</code> är en primär nyckel eftersom den entydigt identifierar varje plan i tabellen <code>planes</code>.</li>
<li>En <em>foreign key</em> identifierar entydigt en observation i en annan T.ex. <code>flights$tailnum</code> är en foreign key eftersom den i tabellen <code>flights</code> matchar varje flight till ett specifikt plan.</li>
</ol>
<p>När du identifierat de primära nycklarna i tabellerna är det klokt att verifiera att de verkligen entydigt identifierar varje observation. Ett effektivt sätt att göra det är att räkna (med hjälp av <code>count()</code>) primärnycklarna och filtrera ut dem som är fler än ett. Pröva:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb322-1" data-line-number="1">planes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb322-2" data-line-number="2"><span class="st">  </span><span class="kw">count</span>(tailnum) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb322-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(n <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## # A tibble: 0 x 2
## # ... with 2 variables: tailnum &lt;chr&gt;, n &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" data-line-number="1">weather <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb324-2" data-line-number="2"><span class="st">  </span><span class="kw">count</span>(year, month, day, hour, origin) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb324-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(n <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 6
##    year month   day  hour origin     n
##   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;int&gt;
## 1  2013    11     3     1 EWR        2
## 2  2013    11     3     1 JFK        2
## 3  2013    11     3     1 LGA        2</code></pre>
<p>Ibland saknas en tabell en explicit <em>primary key</em>: varje rad är en observation men ingen kombination av variabler identifierar den. Till exempel, vilken är primärnyckel i <code>flight</code>-tabellen? Du kanske tänker att det är datum (date) + flight-numret eller tailnum, men ingen av dessa kombinationer är unik:</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb326-1" data-line-number="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb326-2" data-line-number="2"><span class="st">  </span><span class="kw">count</span>(year, month, day, flight) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb326-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(n <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## # A tibble: 29,768 x 5
##     year month   day flight     n
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;
##  1  2013     1     1      1     2
##  2  2013     1     1      3     2
##  3  2013     1     1      4     2
##  4  2013     1     1     11     3
##  5  2013     1     1     15     2
##  6  2013     1     1     21     2
##  7  2013     1     1     27     4
##  8  2013     1     1     31     2
##  9  2013     1     1     32     2
## 10  2013     1     1     35     2
## # ... with 29,758 more rows</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" data-line-number="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb328-2" data-line-number="2"><span class="st">  </span><span class="kw">count</span>(year, month, day, tailnum) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb328-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(n <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## # A tibble: 64,928 x 5
##     year month   day tailnum     n
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;int&gt;
##  1  2013     1     1 N0EGMQ      2
##  2  2013     1     1 N11189      2
##  3  2013     1     1 N11536      2
##  4  2013     1     1 N11544      3
##  5  2013     1     1 N11551      2
##  6  2013     1     1 N12540      2
##  7  2013     1     1 N12567      2
##  8  2013     1     1 N13123      2
##  9  2013     1     1 N13538      3
## 10  2013     1     1 N13566      3
## # ... with 64,918 more rows</code></pre>
<p>Om en tabell saknar en primärnyckel kan det ibland vara vettigt att skapa en med hjälp av <code>mutate()</code> och <code>row_number()</code>, en <em>surrogat-nyckel</em>.</p>
<p>En primärnyckel och en korresponderande <em>foreign key</em> i en annan tabell utgör en relation. Relationer är vanligen en-till-flera. Till exempel, varje flight har ett plan men varje plan har flera flighter. Det finns naturligtvis alla varianter på relationer, en-till-en och flera-till-flera.</p>
</div>
<div id="mutating-joins" class="section level2">
<h2><span class="header-section-number">13.4</span> <em>Mutating joins</em></h2>
<p>Först ska vi kika på ett verktyg för att kombinera två tabeller: <em>the mutating join</em>. Det matchar först poster med hjälp av dess nycklar, sedan kopieras valda variabler från den ena tabellen till den andra.</p>
<p>Liksom <code>mutate()</code>adderar <em>join</em>-funktionerna variabler till höger så om du har många vafriabler blir det svårt att se de nya på skärmen. Vi ska därför, för nedanstående exempel, skapa ett <em>smalare</em> dataset:</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" data-line-number="1">flights2 &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb330-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(year<span class="op">:</span>day, hour, origin, dest, tailnum, carrier)</a>
<a class="sourceLine" id="cb330-3" data-line-number="3">flights2</a></code></pre></div>
<pre><code>## # A tibble: 336,776 x 8
##     year month   day  hour origin dest  tailnum carrier
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  
##  1  2013     1     1     5 EWR    IAH   N14228  UA     
##  2  2013     1     1     5 LGA    IAH   N24211  UA     
##  3  2013     1     1     5 JFK    MIA   N619AA  AA     
##  4  2013     1     1     5 JFK    BQN   N804JB  B6     
##  5  2013     1     1     6 LGA    ATL   N668DN  DL     
##  6  2013     1     1     5 EWR    ORD   N39463  UA     
##  7  2013     1     1     6 EWR    FLL   N516JB  B6     
##  8  2013     1     1     6 LGA    IAD   N829AS  EV     
##  9  2013     1     1     6 JFK    MCO   N593JB  B6     
## 10  2013     1     1     6 LGA    ORD   N3ALAA  AA     
## # ... with 336,766 more rows</code></pre>
<p>(Kom ihåg att du i RStudio alltid kan använda <code>view()</code> för att runda detta problem.)</p>
<p>Låt oss säga att du nu vill komplettera med hela namnet på flygbolaget i <code>flights2</code>. Det kan du göra med <code>left_join()</code>:</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb332-1" data-line-number="1">flights2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb332-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>origin, <span class="op">-</span>dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb332-3" data-line-number="3"><span class="st">  </span><span class="kw">left_join</span>(airlines, <span class="dt">by =</span> <span class="st">&quot;carrier&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 336,776 x 7
##     year month   day  hour tailnum carrier name                    
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                   
##  1  2013     1     1     5 N14228  UA      United Air Lines Inc.   
##  2  2013     1     1     5 N24211  UA      United Air Lines Inc.   
##  3  2013     1     1     5 N619AA  AA      American Airlines Inc.  
##  4  2013     1     1     5 N804JB  B6      JetBlue Airways         
##  5  2013     1     1     6 N668DN  DL      Delta Air Lines Inc.    
##  6  2013     1     1     5 N39463  UA      United Air Lines Inc.   
##  7  2013     1     1     6 N516JB  B6      JetBlue Airways         
##  8  2013     1     1     6 N829AS  EV      ExpressJet Airlines Inc.
##  9  2013     1     1     6 N593JB  B6      JetBlue Airways         
## 10  2013     1     1     6 N3ALAA  AA      American Airlines Inc.  
## # ... with 336,766 more rows</code></pre>
<p>Rsultatet av sammanslagningen är en ytterligare variabel: ´name<code>. Du kan få samma resultat med hjälp av</code>mutate()`:</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb334-1" data-line-number="1">flights2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb334-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>origin, <span class="op">-</span>dest) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb334-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> airlines<span class="op">$</span>name[<span class="kw">match</span>(carrier, airlines<span class="op">$</span>carrier)])</a></code></pre></div>
<pre><code>## # A tibble: 336,776 x 7
##     year month   day  hour tailnum carrier name                    
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                   
##  1  2013     1     1     5 N14228  UA      United Air Lines Inc.   
##  2  2013     1     1     5 N24211  UA      United Air Lines Inc.   
##  3  2013     1     1     5 N619AA  AA      American Airlines Inc.  
##  4  2013     1     1     5 N804JB  B6      JetBlue Airways         
##  5  2013     1     1     6 N668DN  DL      Delta Air Lines Inc.    
##  6  2013     1     1     5 N39463  UA      United Air Lines Inc.   
##  7  2013     1     1     6 N516JB  B6      JetBlue Airways         
##  8  2013     1     1     6 N829AS  EV      ExpressJet Airlines Inc.
##  9  2013     1     1     6 N593JB  B6      JetBlue Airways         
## 10  2013     1     1     6 N3ALAA  AA      American Airlines Inc.  
## # ... with 336,766 more rows</code></pre>
<p>Men detta uttryck är svårt att generalisera när du behöver matcha flera variabler och kräver i så fall en hel del eftertanke.</p>
<p>De följande sektionerna ska diskutera i detalj hur dessa sammanslagningar, <em>mutating joins</em>, fungerar. Vi ska först gå igenom hur <em>joins</em> kan visualiseras, sedan använda dessa visualiseringar för att förklara de fyra <em>join</em>-funktionerna, <em>the inner join</em> och tre <em>outer joins</em>. Vi ska vidare kika på vad som händer om matchninarna inte är unika och hur man hanterar det. Slutligen ska vi se hur man definierar <em>key</em>-variabler för en viss <em>join</em>-funktion.</p>
<div id="att-forsta-joins" class="section level3">
<h3><span class="header-section-number">13.4.1</span> Att förstå <em>joins</em></h3>
<p>Låt oss kika på en visualisering:</p>
<p><img src="join-setup.png" /></p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb336-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb336-2" data-line-number="2">  <span class="op">~</span>key, <span class="op">~</span>val_x,</a>
<a class="sourceLine" id="cb336-3" data-line-number="3">     <span class="dv">1</span>, <span class="st">&quot;x1&quot;</span>,</a>
<a class="sourceLine" id="cb336-4" data-line-number="4">     <span class="dv">2</span>, <span class="st">&quot;x2&quot;</span>,</a>
<a class="sourceLine" id="cb336-5" data-line-number="5">     <span class="dv">3</span>, <span class="st">&quot;x3&quot;</span></a>
<a class="sourceLine" id="cb336-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb336-7" data-line-number="7">y &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb336-8" data-line-number="8">  <span class="op">~</span>key, <span class="op">~</span>val_y,</a>
<a class="sourceLine" id="cb336-9" data-line-number="9">     <span class="dv">1</span>, <span class="st">&quot;y1&quot;</span>,</a>
<a class="sourceLine" id="cb336-10" data-line-number="10">     <span class="dv">2</span>, <span class="st">&quot;y2&quot;</span>,</a>
<a class="sourceLine" id="cb336-11" data-line-number="11">     <span class="dv">4</span>, <span class="st">&quot;y3&quot;</span></a>
<a class="sourceLine" id="cb336-12" data-line-number="12">)</a></code></pre></div>
<p>De färgade kolumnerna representerar nycklarna, the keys - dessa används för att matcha raderna i tabellerna. Den gråa kolumnen representerar <em>värde</em>-kolumnen. I exemplen används en nyckel men det är ganska straightforward att använda funktionerna för flera nycklar och värden. En <em>join</em> är ett sätt att binda samman en rad i tabell x med 0, 1 eller flera poster i tabell y. Nedanstående diagram visar potentiella matchningar som skärningen mellan ett linje-par:</p>
<p><img src="join-setup2.png" /></p>
<p>I figurerna kommer matchningarna att representeras av punkter: antalet punkter = antalet matchningar = antalet rader i output.</p>
</div>
<div id="inner-join" class="section level3">
<h3><span class="header-section-number">13.4.2</span> Inner join</h3>
<p>Den enklaste typen av <em>joins</em> är <em>inner join</em>. En <em>inner join</em> matchar par av observationer när nycklarna är lika:</p>
<p><img src="join-inner.png" /></p>
<p>Ouput från en <em>inner join</em> är en ny data-frame som innehåller nyckeln, x-värdena och y-värdena.Vi använder <code>by</code>för att tala om för <code>dplyr</code>vilken variabel som är nyckel:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb337-1" data-line-number="1">x <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb337-2" data-line-number="2"><span class="st">  </span><span class="kw">inner_join</span>(y, <span class="dt">by =</span> <span class="st">&quot;key&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##     key val_x val_y
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1   
## 2     2 x2    y2</code></pre>
<p>Den viktigaste egenskapen hos en <em>inner join</em> är att icke-matchade poster inte inkluderas i output. Generellt bör man därför vara försiktig med <em>inner joins</em> eftersom det är lätt att tappa data.</p>
</div>
<div id="outer-joins" class="section level3">
<h3><span class="header-section-number">13.4.3</span> Outer joins</h3>
<p>En <em>inner join</em> behåller poster som finns i båda tabellerna. En <em>outer join</em> behåller poster som finns åtminstone i en av tabellerna. Det finns tre typer av <em>outer joins</em>:</p>
<ul>
<li>en <em>left join</em> behåller alla poster i x</li>
<li>en <em>righth join</em> behåller alla poster i y</li>
<li>en <em>full join</em> behåller alla poster i x och y</li>
</ul>
<p>Dessa <em>joins</em> fungerar genom att lägga till en “virtuell” post till vardera tabellerna. Denna post har en <em>key</em> som alltid matchar (om ingen annan <em>key</em> matchar), och ett värde = NA. Grafiskt kan det illustreras så här:</p>
<p>[(join-outer.png)]</p>
<p>Den vanligast förekommande <em>join</em> är <em>left joins</em>. Du använder denna närhelst du vill lägga till data från en annan tabell eftersom den bevarar samtliga poster i original-tabellen, även om de inte har någon matchning.</p>
</div>
<div id="duplicate-keys" class="section level3">
<h3><span class="header-section-number">13.4.4</span> Duplicate keys</h3>
<p>Så här långt har vi antagit att <em>keys</em> är unika. Men det är inte alltid fallet. Och vafd händer då? Det finns två möjligheter:</p>
<ol style="list-style-type: decimal">
<li>En av tabellerna har dubbla <em>keys</em>. Detta är användbart då du vill lägga till ytterligare information eftersom detta vanligen är en en-till-flera-relation.</li>
</ol>
<p>[(join-one-to-many.png)]</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb339-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb339-2" data-line-number="2">  <span class="op">~</span>key, <span class="op">~</span>val_x,</a>
<a class="sourceLine" id="cb339-3" data-line-number="3">     <span class="dv">1</span>, <span class="st">&quot;x1&quot;</span>,</a>
<a class="sourceLine" id="cb339-4" data-line-number="4">     <span class="dv">2</span>, <span class="st">&quot;x2&quot;</span>,</a>
<a class="sourceLine" id="cb339-5" data-line-number="5">     <span class="dv">2</span>, <span class="st">&quot;x3&quot;</span>,</a>
<a class="sourceLine" id="cb339-6" data-line-number="6">     <span class="dv">1</span>, <span class="st">&quot;x4&quot;</span></a>
<a class="sourceLine" id="cb339-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb339-8" data-line-number="8">y &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb339-9" data-line-number="9">  <span class="op">~</span>key, <span class="op">~</span>val_y,</a>
<a class="sourceLine" id="cb339-10" data-line-number="10">     <span class="dv">1</span>, <span class="st">&quot;y1&quot;</span>,</a>
<a class="sourceLine" id="cb339-11" data-line-number="11">     <span class="dv">2</span>, <span class="st">&quot;y2&quot;</span></a>
<a class="sourceLine" id="cb339-12" data-line-number="12">)</a>
<a class="sourceLine" id="cb339-13" data-line-number="13"><span class="kw">left_join</span>(x, y, <span class="dt">by =</span> <span class="st">&quot;key&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##     key val_x val_y
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1   
## 2     2 x2    y2   
## 3     2 x3    y2   
## 4     1 x4    y1</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Båda tabellerna har dubbla <em>keys</em>. Detta är vanligtvis ett <em>error</em> eftersom ingen av nycklarna identifierar en unik post. När du slår samman dubbla nycklar kommer du att få samtliga möjliga kombinationer av poster, den Cartesianska produkten:</li>
</ol>
<p>[(join-many-to-many.png)]</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb341-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb341-2" data-line-number="2">  <span class="op">~</span>key, <span class="op">~</span>val_x,</a>
<a class="sourceLine" id="cb341-3" data-line-number="3">     <span class="dv">1</span>, <span class="st">&quot;x1&quot;</span>,</a>
<a class="sourceLine" id="cb341-4" data-line-number="4">     <span class="dv">2</span>, <span class="st">&quot;x2&quot;</span>,</a>
<a class="sourceLine" id="cb341-5" data-line-number="5">     <span class="dv">2</span>, <span class="st">&quot;x3&quot;</span>,</a>
<a class="sourceLine" id="cb341-6" data-line-number="6">     <span class="dv">3</span>, <span class="st">&quot;x4&quot;</span></a>
<a class="sourceLine" id="cb341-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb341-8" data-line-number="8">y &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb341-9" data-line-number="9">  <span class="op">~</span>key, <span class="op">~</span>val_y,</a>
<a class="sourceLine" id="cb341-10" data-line-number="10">     <span class="dv">1</span>, <span class="st">&quot;y1&quot;</span>,</a>
<a class="sourceLine" id="cb341-11" data-line-number="11">     <span class="dv">2</span>, <span class="st">&quot;y2&quot;</span>,</a>
<a class="sourceLine" id="cb341-12" data-line-number="12">     <span class="dv">2</span>, <span class="st">&quot;y3&quot;</span>,</a>
<a class="sourceLine" id="cb341-13" data-line-number="13">     <span class="dv">3</span>, <span class="st">&quot;y4&quot;</span></a>
<a class="sourceLine" id="cb341-14" data-line-number="14">)</a>
<a class="sourceLine" id="cb341-15" data-line-number="15"><span class="kw">left_join</span>(x, y, <span class="dt">by =</span> <span class="st">&quot;key&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##     key val_x val_y
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1   
## 2     2 x2    y2   
## 3     2 x2    y3   
## 4     2 x3    y2   
## 5     2 x3    y3   
## 6     3 x4    y4</code></pre>
</div>
<div id="definiera-nyckel-kolumner-key-columns" class="section level3">
<h3><span class="header-section-number">13.4.5</span> Definiera nyckel-kolumner (<em>key columns</em>)</h3>
<p>Hittills har tabellerna alltid slagits samman med hjälp av en enskild variabel (definierad med <code>by</code>) vilken varit densamma i båda tabellerna. Men du kan använda andra värden till <code>by</code> för att binda samman tabellerna:</p>
<ul>
<li>default är <code>by = NULL</code>, som användeer samtliga variabler som är lika i båda tabellerna. Till exempel matchar <code>flights</code> och <code>weather</code>-tabellerna via de gemensamma variablerna: <code>year</code>, <code>month</code>, <code>day</code>, <code>hour</code> och <code>origin</code>.</li>
</ul>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb343-1" data-line-number="1">flights2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb343-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(weather)</a></code></pre></div>
<pre><code>## Joining, by = c(&quot;year&quot;, &quot;month&quot;, &quot;day&quot;, &quot;hour&quot;, &quot;origin&quot;)</code></pre>
<pre><code>## # A tibble: 336,776 x 18
##     year month   day  hour origin dest  tailnum carrier  temp  dewp humid
##    &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  2013     1     1     5 EWR    IAH   N14228  UA       39.0  28.0  64.4
##  2  2013     1     1     5 LGA    IAH   N24211  UA       39.9  25.0  54.8
##  3  2013     1     1     5 JFK    MIA   N619AA  AA       39.0  27.0  61.6
##  4  2013     1     1     5 JFK    BQN   N804JB  B6       39.0  27.0  61.6
##  5  2013     1     1     6 LGA    ATL   N668DN  DL       39.9  25.0  54.8
##  6  2013     1     1     5 EWR    ORD   N39463  UA       39.0  28.0  64.4
##  7  2013     1     1     6 EWR    FLL   N516JB  B6       37.9  28.0  67.2
##  8  2013     1     1     6 LGA    IAD   N829AS  EV       39.9  25.0  54.8
##  9  2013     1     1     6 JFK    MCO   N593JB  B6       37.9  27.0  64.3
## 10  2013     1     1     6 LGA    ORD   N3ALAA  AA       39.9  25.0  54.8
## # ... with 336,766 more rows, and 7 more variables: wind_dir &lt;dbl&gt;,
## #   wind_speed &lt;dbl&gt;, wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;, pressure &lt;dbl&gt;,
## #   visib &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ul>
<li>en <em>character</em>-vektor, <code>by = &quot;x&quot;</code>. Detta liknar ovanstående men använder endast en eller några av de gemensamma variablerna. Tilll exempel har både <code>flights</code>och <code>planes</code> <code>year</code>gemensamt men de betyder olika saker så vi vill bara använda <code>tailnum</code>för att slå samman tabellerna:</li>
</ul>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb346-1" data-line-number="1">flights2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb346-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(planes, <span class="dt">by =</span> <span class="st">&quot;tailnum&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 336,776 x 16
##    year.x month   day  hour origin dest  tailnum carrier year.y type 
##     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;
##  1   2013     1     1     5 EWR    IAH   N14228  UA        1999 Fixe~
##  2   2013     1     1     5 LGA    IAH   N24211  UA        1998 Fixe~
##  3   2013     1     1     5 JFK    MIA   N619AA  AA        1990 Fixe~
##  4   2013     1     1     5 JFK    BQN   N804JB  B6        2012 Fixe~
##  5   2013     1     1     6 LGA    ATL   N668DN  DL        1991 Fixe~
##  6   2013     1     1     5 EWR    ORD   N39463  UA        2012 Fixe~
##  7   2013     1     1     6 EWR    FLL   N516JB  B6        2000 Fixe~
##  8   2013     1     1     6 LGA    IAD   N829AS  EV        1998 Fixe~
##  9   2013     1     1     6 JFK    MCO   N593JB  B6        2004 Fixe~
## 10   2013     1     1     6 LGA    ORD   N3ALAA  AA          NA &lt;NA&gt; 
## # ... with 336,766 more rows, and 6 more variables: manufacturer &lt;chr&gt;,
## #   model &lt;chr&gt;, engines &lt;int&gt;, seats &lt;int&gt;, speed &lt;int&gt;, engine &lt;chr&gt;</code></pre>
<p>Notera att <code>year</code>-variablerna fått ett suffix vilket för att understryka att det är två olika variabler.</p>
<ul>
<li>en namngiven <em>character</em>-vektor, <code>by = c(&quot;a&quot; = &quot;b&quot;). Detta kommer att matcha variabel</code>a<code>i tabell</code>x<code>med variabel</code>b<code>i tabell</code>y<code>. Variablerna i</code>x<code>kommer att användas i output. Om vi till exempel vill göra en karta behöver vi kombinera</code>flights<code>med</code>airports` vilken innehåller koordinaterna för flygplatserna. Eftersom varje flight har en avgångs-flygplats och en destination behöver vi specificera vilken av flygpplatserna som vi vill använda för kartan:</li>
</ul>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb348-1" data-line-number="1">flights2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb348-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(airports, <span class="kw">c</span>(<span class="st">&quot;dest&quot;</span> =<span class="st"> &quot;faa&quot;</span>))</a></code></pre></div>
<pre><code>## # A tibble: 336,776 x 15
##     year month   day  hour origin dest  tailnum carrier name    lat   lon
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  2013     1     1     5 EWR    IAH   N14228  UA      Geor~  30.0 -95.3
##  2  2013     1     1     5 LGA    IAH   N24211  UA      Geor~  30.0 -95.3
##  3  2013     1     1     5 JFK    MIA   N619AA  AA      Miam~  25.8 -80.3
##  4  2013     1     1     5 JFK    BQN   N804JB  B6      &lt;NA&gt;   NA    NA  
##  5  2013     1     1     6 LGA    ATL   N668DN  DL      Hart~  33.6 -84.4
##  6  2013     1     1     5 EWR    ORD   N39463  UA      Chic~  42.0 -87.9
##  7  2013     1     1     6 EWR    FLL   N516JB  B6      Fort~  26.1 -80.2
##  8  2013     1     1     6 LGA    IAD   N829AS  EV      Wash~  38.9 -77.5
##  9  2013     1     1     6 JFK    MCO   N593JB  B6      Orla~  28.4 -81.3
## 10  2013     1     1     6 LGA    ORD   N3ALAA  AA      Chic~  42.0 -87.9
## # ... with 336,766 more rows, and 4 more variables: alt &lt;int&gt;, tz &lt;dbl&gt;,
## #   dst &lt;chr&gt;, tzone &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb350-1" data-line-number="1">flights2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb350-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(airports, <span class="kw">c</span>(<span class="st">&quot;origin&quot;</span> =<span class="st"> &quot;faa&quot;</span>))</a></code></pre></div>
<pre><code>## # A tibble: 336,776 x 15
##     year month   day  hour origin dest  tailnum carrier name    lat   lon
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  2013     1     1     5 EWR    IAH   N14228  UA      Newa~  40.7 -74.2
##  2  2013     1     1     5 LGA    IAH   N24211  UA      La G~  40.8 -73.9
##  3  2013     1     1     5 JFK    MIA   N619AA  AA      John~  40.6 -73.8
##  4  2013     1     1     5 JFK    BQN   N804JB  B6      John~  40.6 -73.8
##  5  2013     1     1     6 LGA    ATL   N668DN  DL      La G~  40.8 -73.9
##  6  2013     1     1     5 EWR    ORD   N39463  UA      Newa~  40.7 -74.2
##  7  2013     1     1     6 EWR    FLL   N516JB  B6      Newa~  40.7 -74.2
##  8  2013     1     1     6 LGA    IAD   N829AS  EV      La G~  40.8 -73.9
##  9  2013     1     1     6 JFK    MCO   N593JB  B6      John~  40.6 -73.8
## 10  2013     1     1     6 LGA    ORD   N3ALAA  AA      La G~  40.8 -73.9
## # ... with 336,766 more rows, and 4 more variables: alt &lt;int&gt;, tz &lt;dbl&gt;,
## #   dst &lt;chr&gt;, tzone &lt;chr&gt;</code></pre>
</div>
<div id="ovningar-18" class="section level3">
<h3><span class="header-section-number">13.4.6</span> Övningar</h3>
<ol style="list-style-type: decimal">
<li>Beräkna den genomsnittliga förseningen per destination, sedan slå samman tabellen med <code>airports</code>så att du kan visa den geografiska fördelningen av förseningar. Här är ett enkelt sätt att rita en karta över USA:</li>
</ol>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb352-1" data-line-number="1">airports <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb352-2" data-line-number="2"><span class="st">  </span><span class="kw">semi_join</span>(flights, <span class="kw">c</span>(<span class="st">&quot;faa&quot;</span> =<span class="st"> &quot;dest&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb352-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(lon, lat)) <span class="op">+</span></a>
<a class="sourceLine" id="cb352-4" data-line-number="4"><span class="st">    </span><span class="kw">borders</span>(<span class="st">&quot;state&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb352-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb352-6" data-line-number="6"><span class="st">    </span><span class="kw">coord_quickmap</span>()</a></code></pre></div>
<p>Bekymra dig inte om du inte förstår vad <code>semi_join()</code> gör - vi återkommer strax till denna funktion.</p>
<ol start="2" style="list-style-type: decimal">
<li>Lägg till koordinaterna för avgångs- och destinations-flygplatserna till <code>flights</code>.</li>
<li>Vid vilka vädertyper är en försening mer sannolik?</li>
</ol>
</div>
</div>
<div id="filtering-joins" class="section level2">
<h2><span class="header-section-number">13.5</span> <em>Filtering joins</em></h2>
<p><em>Filtering joins</em> matchar poster på samma sätt som <em>mutating joins</em> men påverkar posterna snarare än variablerna. Det finns två typer:</p>
<ul>
<li><code>semi_join(x, y)</code> behåller samtliga poster i <code>x</code>som har en matchning i <code>y</code>.</li>
<li>ànti-join(x, y)<code>droppar samtliga poster i</code>x<code>som har en matchning i</code>y`.</li>
</ul>
<p><em>Semi-joins</em> är användbara för att matcha filtrerade summerade variabler tillbaka till de ursprungliga posterna. Till exempel, tänk dig att du har identifierat de tio mest ppopulära destinationerna:</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb353-1" data-line-number="1">top_dest &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb353-2" data-line-number="2"><span class="st">  </span><span class="kw">count</span>(dest, <span class="dt">sort =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb353-3" data-line-number="3"><span class="st">  </span><span class="kw">head</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb353-4" data-line-number="4">top_dest</a></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##    dest      n
##    &lt;chr&gt; &lt;int&gt;
##  1 ORD   17283
##  2 ATL   17215
##  3 LAX   16174
##  4 BOS   15508
##  5 MCO   14082
##  6 CLT   14064
##  7 SFO   13331
##  8 FLL   12055
##  9 MIA   11728
## 10 DCA    9705</code></pre>
<p>Du vill nu identifiera samtliga flighter som gick till någon av dessa destinationer. Du kan själv definiera ett filter:</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb355-1" data-line-number="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb355-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(dest <span class="op">%in%</span><span class="st"> </span>top_dest<span class="op">$</span>dest)</a></code></pre></div>
<pre><code>## # A tibble: 141,145 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
##  1  2013     1     1      542            540         2      923
##  2  2013     1     1      554            600        -6      812
##  3  2013     1     1      554            558        -4      740
##  4  2013     1     1      555            600        -5      913
##  5  2013     1     1      557            600        -3      838
##  6  2013     1     1      558            600        -2      753
##  7  2013     1     1      558            600        -2      924
##  8  2013     1     1      558            600        -2      923
##  9  2013     1     1      559            559         0      702
## 10  2013     1     1      600            600         0      851
## # ... with 141,135 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
## #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
## #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
## #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Men det är svårt att använda denna ansats för multipla nycklar. Om du till exempel identifierat de 10 dagar som haft de största genomsnittliga förseningarna. Hur skulle du konstruera ett filter som använde <code>year</code>, <code>month</code> och <code>day</code> för att matcha tillbaka till <code>flights</code>?
Istället kan du använda en <em>semi-join</em> som knyter ihop de två tabellerna på samma sätt som en <em>mutating join</em> men istället för att lägga till nya kolumner använder endast de poster i <code>x</code>som har en matchning i <code>y</code>:</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb357-1" data-line-number="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb357-2" data-line-number="2"><span class="st">  </span><span class="kw">semi_join</span>(top_dest)</a></code></pre></div>
<pre><code>## Joining, by = &quot;dest&quot;</code></pre>
<pre><code>## # A tibble: 141,145 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
##  1  2013     1     1      542            540         2      923
##  2  2013     1     1      554            600        -6      812
##  3  2013     1     1      554            558        -4      740
##  4  2013     1     1      555            600        -5      913
##  5  2013     1     1      557            600        -3      838
##  6  2013     1     1      558            600        -2      753
##  7  2013     1     1      558            600        -2      924
##  8  2013     1     1      558            600        -2      923
##  9  2013     1     1      559            559         0      702
## 10  2013     1     1      600            600         0      851
## # ... with 141,135 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
## #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
## #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
## #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Grafiskt ser en <em>semi-join</em> ut så här:</p>
<p><img src="join-semi.png" /></p>
<p>Det är bara själva förekomsten av en matchning som är intressant; det spelar iingen roll vilken post som matchar. Detta innebär att <em>filtering joins</em> aldrig duplikerar poster vilket <em>mutating joins</em> kan göra:</p>
<p><img src="join-semi-many.png" /></p>
<p>Inversen av en <em>semi-join</em> är en <em>anti-join</em>. En <em>anti-join</em> behåller poster som <em>inte</em> har en matchning:</p>
<p><img src="join-anti.png" /></p>
<p><em>Anti-joins</em> är användbara för att felsöka sammanslagningar som misslyckats. Till exempel, om man binder samman <code>flights</code> och <code>planes</code> kan det vara bra att veta hur många flighter som inte har en matchning i <code>planes</code>:</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb360-1" data-line-number="1">flights <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb360-2" data-line-number="2"><span class="st">  </span><span class="kw">anti_join</span>(planes, <span class="dt">by =</span> <span class="st">&quot;tailnum&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb360-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>(tailnum, <span class="dt">sort =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## # A tibble: 722 x 2
##    tailnum     n
##    &lt;chr&gt;   &lt;int&gt;
##  1 &lt;NA&gt;     2512
##  2 N725MQ    575
##  3 N722MQ    513
##  4 N723MQ    507
##  5 N713MQ    483
##  6 N735MQ    396
##  7 N0EGMQ    371
##  8 N534MQ    364
##  9 N542MQ    363
## 10 N531MQ    349
## # ... with 712 more rows</code></pre>
<p>I Wickham´s bok finns några nyttiga övningar. Kolla in <a href="https://r4ds.had.co.nz/relational-data.html#exercises-29" class="uri">https://r4ds.had.co.nz/relational-data.html#exercises-29</a>.</p>
</div>
<div id="problem-med-joins" class="section level2">
<h2><span class="header-section-number">13.6</span> Problem med <em>joins</em></h2>
<p>Några saker att tänka på:</p>
<ol style="list-style-type: decimal">
<li>Börja med att identifiera <em>key</em>-variabeln eller en kombination av variabler i vardera tabellen som identifierar varje post unikt.</li>
<li>Se till så att inga av variablerna i den primära nyckeln är <em>missing</em> - annars går det inte att identifiera observationen!</li>
<li>Kolla så att <em>foreign keys</em> matchar primära nycklar i andra tabeller. Ett smart sätt att göra det är att använda <code>anti_join()</code>.</li>
</ol>
<p>Om du upptäcker att nycklar saknas behöver du vara noggrann med hur du användere <em>inner joins</em> och <em>outer joins</em>, och fundera över om du vill skippa observationer/poster som inte har en matchning.</p>
</div>
<div id="set-operations" class="section level2">
<h2><span class="header-section-number">13.7</span> Set operations</h2>
<p>DEn sista typen av begrepp är <em>set operations</em>. De kan vara bra då du vill bryta upp ett enstaka komplext filter i enklare delar. Samtliga <em>operations</em> arbetar på en hel post/rad och jämför värdena för varje variabel. De utgår från att x- och y-tabellerna har samma variabler och behandlar posterna som <em>set</em>:</p>
<ul>
<li><code>intersect(x, y)</code> returnerar enbart observationer i både x och y.</li>
<li><code>union(x, y)</code> returnerar unika observationer i både x och y.</li>
<li><code>setdiff(x, y)</code> returnerar observationer i x som inte finns i y.</li>
</ul>
<p>t.ex:</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb362-1" data-line-number="1">df1 &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb362-2" data-line-number="2">  <span class="op">~</span>x, <span class="op">~</span>y,</a>
<a class="sourceLine" id="cb362-3" data-line-number="3">   <span class="dv">1</span>,  <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb362-4" data-line-number="4">   <span class="dv">2</span>,  <span class="dv">1</span></a>
<a class="sourceLine" id="cb362-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb362-6" data-line-number="6">df2 &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb362-7" data-line-number="7">  <span class="op">~</span>x, <span class="op">~</span>y,</a>
<a class="sourceLine" id="cb362-8" data-line-number="8">   <span class="dv">1</span>,  <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb362-9" data-line-number="9">   <span class="dv">1</span>,  <span class="dv">2</span></a>
<a class="sourceLine" id="cb362-10" data-line-number="10">)</a></code></pre></div>
<p>Det finns fyra möjligheter:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb363-1" data-line-number="1"><span class="kw">intersect</span>(df1, df2)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##       x     y
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     1     1</code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb365-1" data-line-number="1"><span class="kw">union</span>(df1, df2)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##       x     y
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     1     2
## 2     2     1
## 3     1     1</code></pre>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb367-1" data-line-number="1"><span class="kw">setdiff</span>(df1, df2)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##       x     y
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     2     1</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb369-1" data-line-number="1"><span class="kw">setdiff</span>(df2, df1)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##       x     y
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     1     2</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="stada-data-tidy-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="textstrangar-strings.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

</body>

</html>
